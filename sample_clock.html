<body>
    <div 
        tabindex="0"
        onkeydown="playHat()"
        style="background:black; height:100%;"
    >
        
    </div>
    
</body>

<script>

var audio_context = window.AudioContext || window.webkitAudioContext;
var con = new audio_context();


var hat;


var hat_seq = [1, 1, 1, 1, 1, 1];
var step = 0;


setInterval(function(){
    if (hat_seq[step % hat_seq.length] == 1){
        playHat();
    }
    step = step + 1;

}, 250);


loadSample('cl_hat_3001.wav', function (buffer){
    hat = buffer; 
});




function playHat(){
     var player = con.createBufferSource();
    player.buffer = hat;
    player.start(); 
    player.loop = false;
    player.connect(con.destination);  
}




function loadSample(url, callback){
    var request = new XMLHttpRequest();
    request.open('GET', url, true);
    request.responseType = 'arraybuffer';
    request.onload = function(){
        var audioData = request.response;
        con.decodeAudioData(audioData, function(buffer) {
            console.log(buffer);
            callback(buffer);
        });
    };
    request.send();
}

    
</script>
